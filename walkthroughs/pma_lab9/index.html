<!DOCTYPE html>
<html lang="fr">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.78.2" />

    
    
    

<title>Practical Malware Analysis - Lab 9 • </title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Practical Malware Analysis - Lab 9"/>
<meta name="twitter:description" content="Sixth exercice of the Practical Malware Analysis book. This lab focuses on OllyDbg developed by Oleh Yuschuk."/>

<meta property="og:title" content="Practical Malware Analysis - Lab 9" />
<meta property="og:description" content="Sixth exercice of the Practical Malware Analysis book. This lab focuses on OllyDbg developed by Oleh Yuschuk." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nikj-fr.github.io/walkthroughs/pma_lab9/" />
<meta property="article:published_time" content="2021-01-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-12T00:00:00+00:00" /><meta property="og:site_name" content="Nikj | Personal Website" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.d0c4ffb2e1828bd88212c4246b2911d84b93350f28f2d499f40bb11f1bd57e9a.css" integrity="sha256-0MT/suGCi9iCEsQkaykR2EuTNQ8o8tSZ9AuxHxvVfpo=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://nikj-fr.github.io/"></a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://nikj-fr.github.io/images/profil.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         InfoSec Website | CTF WriteUp 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle"></label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/walkthroughs/">
						<span>Walkthroughs</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/writeup/">
						<span>Write-Ups</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/cheatsheets/">
						<span>Cheatsheets &amp; Ressources</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/articles/">
						<span>Articles</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About-Me</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/%3cusername%3e" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/Nikj-Fr" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	<a href="https://gitlab.com/Nikj-Fr" rel="me"><i class="fab fa-gitlab fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	<a href="mailto:jallet.nicolas16@gmail.com" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2019 - 2021 htr3n
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Practical Malware Analysis - Lab 9</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jan 12, 2021
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 2 min read
</div>


  </header>
  
  
  <div class="post">
    <h2 id="ollydbg"><strong>OllyDBG</strong></h2>
<h3 id="lab-9"><strong>Lab 9</strong></h3>
<p>This lab focuses on OllyDbg developed by Oleh Yuschuk. OllyDbg provides the ability to analyze malware while it is running. The tool is free, it has many plugins that extend it&rsquo;s capabilities</p>
<h3 id="lab-9-1"><strong>Lab 9-1</strong></h3>
<h4 id="how-can-you-get-this-malware-to-install-itself-"><strong>How can you get this malware to install itself ?</strong></h4>
<h4 id="what-are-the-command-line-options-for-this-program--what-is-the-password-requirements-"><strong>What are the command-line options for this program ? What is the password requirements ?</strong></h4>
<h4 id="how-can-you-use-ollydbg-to-permanently-patch-this-malware-so-that-it-doesnt-require-the-special-command-line-password-"><strong>How can you use OllyDbg to permanently patch this malware, so that it doesn&rsquo;t require the special command-line password ?</strong></h4>
<h4 id="what-are-the-host-based-indicators-of-this-malware-"><strong>What are the host-based indicators of this malware ?</strong></h4>
<h4 id="what-are-the-different-actions-this-malware-can-be-instructed-to-take-via-the-network-"><strong>What are the different actions this malware can be instructed to take via the network ?</strong></h4>
<h4 id="are-there-any-useful-network-based-signatures-for-this-malware-"><strong>Are there any useful network-based signatures for this malware ?</strong></h4>
<h3 id="lab-92"><strong>Lab-9.2</strong></h3>
<h4 id="what-strings-do-you-see-statically-in-the-binary-"><strong>What strings do you see statically in the binary ?</strong></h4>
<h4 id="what-happens-when-you-run-this-binary-"><strong>What happens when you run this binary ?</strong></h4>
<h4 id="how-can-you-get-this-sample-to-run-its-malicious-payload-"><strong>How can you get this sample to run its malicious payload ?</strong></h4>
<h4 id="what-is-happening-at-0x00401133-"><strong>What is happening at 0x00401133 ?</strong></h4>
<h4 id="what-arguments-are-being-passed-to-subroutine-0x004401089-"><strong>What arguments are being passed to subroutine 0x004401089 ?</strong></h4>
<h4 id="what-domain-name-does-this-malware-use-"><strong>What domain name does this malware use ?</strong></h4>
<h4 id="what-encoding-routine-is-being-used-to-obfuscate-the-domain-name-"><strong>What encoding routine is being used to obfuscate the domain name ?</strong></h4>
<h4 id="what-is-the-significance-of-the-createprocessa-call-at-0x0040106e-"><strong>What is the significance of the CreateProcessA call at 0x0040106E ?</strong></h4>
<h3 id="lab-93"><strong>Lab-9.3</strong></h3>
<p>This malware loads three included DLLs that are all built to request the same memory load location. Therefore, when viewing these DLLs in OllyDbg versus IDA Pro, code may appear at different memory locations.</p>
<h4 id="what-dlls-are-imported-by-lab09-03exe-"><strong>What DLLs are imported by Lab09-03.exe ?</strong></h4>
<h4 id="what-is-the-base-address-requested-by-dll1dll-dll2dll-dll3dll-"><strong>What is the base address requested by DLL1.dll, DLL2.dll, DLL3.dll ?</strong></h4>
<h4 id="when-you-use-ollydbg-to-debug-lab09-03exe-what-is-the-assigned-based-address-for-dll1dll-dll2dll-and-dll3dll-"><strong>When you use OllyDbg to debug Lab09-03.exe, what is the assigned based address for: DLL1.dll, DLL2.dll, and DLL3.dll ?</strong></h4>
<h4 id="when-lab0-03exe-calls-an-import-function-from-dll1dll-what-does-this-function-do-"><strong>When Lab0&quot;-03.exe calls an import function from DLL1.dll, what does this function do ?</strong></h4>
<h4 id="when-lab09-03exe-calls-writefile-whats-is-the-filename-it-writes-to-"><strong>When Lab09-03.exe calls WriteFile, whats is the filename it writes to ?</strong></h4>
<h4 id="when-lab09-03exe-creates-a-job-using-netschedulejobadd-where-does-it-get-the-data-for-the-second-parameter-"><strong>When Lab09-03.exe creates a job using <em>NetScheduleJobAdd</em>, where does it get the data for the second parameter ?</strong></h4>
<h4 id="while-running-or-debugging-the-program-you-will-see-that-it-prints-out-three-pieces-of-mystery-data-what-are-the-following-dll-1-mystery-data-1-dmm2-mystery-2-and-dll-3-mystery-data-3-"><strong>While running or debugging the program, you will see that it prints out three pieces of mystery data. What are the following: DLL 1 mystery data 1, DMM2 mystery 2, and DLL, 3 mystery data 3 ?</strong></h4>
<h4 id="how-can-you-load-dll2dll-into-ida-pro-so-that-it-matches-the-load-address-used-by-ollydbg-"><strong>How can you load DLL2.dll into IDA Pro so that it matches the load address used by OllyDbg ?</strong></h4>
<p><img src="/images/walkthroughs/pma_lab7/lab-7-1_call_sub_401040.png" alt="call_sub_401040"></p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/walkthroughs/pma_lab6/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Practical Malware Analysis - Lab 6</span>
    </a>
    
    
    <a href="/walkthroughs/pma_lab7/" class="navigation-next">
      <span class="navigation-tittle">Practical Malware Analysis - Lab 7</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'your-google-analytics-id', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
